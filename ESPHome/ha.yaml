esphome:
  name: zen5
  friendly_name: Zen5

esp32:
  board: esp32dev
  framework:
    type: esp-idf

# Enable logging
logger:

# Enable Home Assistant API
api:
  encryption:
    key: "FROM INIT" # auto generated by HA when creating the device

ota:
  - platform: esphome
    password: "FROM INIT" # auto generated by HA when creating the device

# --- cut here ---
# above the line are things prefilled by HA when creating an empty ESPHome device

# also filled by HA, but we have some potential for custom edits
wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password
  # use_address: 192.168.x.x # specify IP this device gets, can be useful if HA and ESP32 are on different networks

captive_portal:
    
switch:
  - platform: gpio
    name: Reset Pin
    id: reset_pin
    pin:
      number: GPIO18
      inverted: True
      mode:
          output: True
          open_drain: True
    on_turn_on:
    - delay: 200ms
    - switch.turn_off: reset_pin

  - platform: gpio
    name: Power Pin Short
    id: power_pin_short
    pin:
      number: GPIO21
      inverted: True
      mode:
          output: True
          open_drain: True
    on_turn_on:
    - delay: 200ms
    - switch.turn_off: power_pin_short
    interlock: [power_pin_long, power_pin_short]

  - platform: gpio
    name: Power Pin Long
    id: power_pin_long
    pin:
      number: GPIO19
      inverted: True
      mode:
          output: True
          open_drain: True
    on_turn_on:
    - delay: 6000ms
    - switch.turn_off: power_pin_long
    interlock: [power_pin_long, power_pin_short]

binary_sensor:
  - platform: gpio
    pin:
      number: GPIO5
      mode: 
        input: True
        pulldown: True
    id: power_led
    name: Power LED
    filters: 
      - delayed_on_off: 100ms
